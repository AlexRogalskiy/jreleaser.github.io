plugins {
    id 'org.jbake.site'             version '5.3.0'
    id 'org.ajoberstar.git-publish' version '3.0.0'
}

jbake {
    configuration['asciidoctor.attributes.export'] = true
    configuration['asciidoctor.attributes.export.prefix'] = 'jbake-'
    configuration['jreleaser-version'] = '0.1.0-SNAPSHOT'

    version = '2.6.5'
}

gitPublish {
    repoUri = 'https://github.com/jreleaser/jreleaser.github.io.git'
    branch  = 'gh-pages'
    contents {
        from project.tasks.findByName('bake').outputs.files
    }
    commitMessage = 'Publish site'
}

gitPublishCommit.dependsOn(project.tasks.findByName('bake'))

task publish {
    dependsOn(bake, gitPublishPush)
}